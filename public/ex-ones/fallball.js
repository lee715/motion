// Generated by CoffeeScript 1.6.3
(function() {
  define(['../graphic/factory', '../track/mix'], function(F, M) {
    return F["class"]('fallball', function(t, times, decay) {
      this.t = this._t = t;
      this.times = times;
      this.decay = decay || 0.9;
      this.a = -10;
      this.b = this._b = 10 * t * times;
      this.reverse = false;
      this.isEnded = false;
      return this;
    }, {
      endType: 'upspring',
      upspring: function() {
        var dc;
        dc = this.decay;
        if (this.reverse) {
          this.b *= dc;
          this.t *= dc;
          if (this.t < 0.01) {
            this.isEnded = true;
          }
        }
        return this.reverse = !this.reverse;
      },
      getX: function(x) {
        if (this.reverse) {
          x = this.t - x;
        }
        x *= this.times;
        return x;
      },
      fix: function(times) {
        var dc, stage;
        if (!times) {
          return;
        }
        stage = times % 2;
        times = Math.ceil(times / 2);
        if (!stage) {
          dc = util.power(this.decay, times);
          this.b = this._b * dc;
          this.t = this._t * dc;
          if (this.t < 0.01) {
            this.isEnded = true;
          }
        }
        return this.reverse = !!stage;
      }
    }, 'line');
  });

}).call(this);
